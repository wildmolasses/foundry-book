<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Foundry Book</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Introduction</a></li><li class="chapter-item expanded "><a href="getting-started/index.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="getting-started/installation.html"><strong aria-hidden="true">1.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="getting-started/first-steps.html"><strong aria-hidden="true">1.2.</strong> First Steps with Foundry</a></li></ol></li><li class="chapter-item expanded "><a href="forge/index.html"><strong aria-hidden="true">2.</strong> Forge Guide</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="forge/creating-a-new-project.html"><strong aria-hidden="true">2.1.</strong> Creating a New Project</a></li><li class="chapter-item expanded "><a href="forge/working-on-an-existing-project.html"><strong aria-hidden="true">2.2.</strong> Working on an Existing Project</a></li><li class="chapter-item expanded "><a href="forge/dependencies.html"><strong aria-hidden="true">2.3.</strong> Dependencies</a></li><li class="chapter-item expanded "><a href="forge/project-layout.html"><strong aria-hidden="true">2.4.</strong> Project Layout</a></li><li class="chapter-item expanded "><a href="forge/config.html"><strong aria-hidden="true">2.5.</strong> Configuring with foundry.toml</a></li><li class="chapter-item expanded "><a href="forge/tests.html"><strong aria-hidden="true">2.6.</strong> Tests</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="forge/writing-tests.html"><strong aria-hidden="true">2.6.1.</strong> Writing Tests</a></li><li class="chapter-item expanded "><a href="forge/cheatcodes.html"><strong aria-hidden="true">2.6.2.</strong> Cheatcodes</a></li><li class="chapter-item expanded "><a href="forge/fuzz-testing.html"><strong aria-hidden="true">2.6.3.</strong> Fuzz Testing</a></li><li class="chapter-item expanded "><a href="forge/traces.html"><strong aria-hidden="true">2.6.4.</strong> Understanding Traces</a></li></ol></li><li class="chapter-item expanded "><a href="forge/continous-integration.html"><strong aria-hidden="true">2.7.</strong> Continous Integration</a></li><li class="chapter-item expanded "><a href="forge/debugger.html"><strong aria-hidden="true">2.8.</strong> Debugger</a></li><li class="chapter-item expanded "><a href="forge/cache.html"><strong aria-hidden="true">2.9.</strong> Cache</a></li></ol></li><li class="chapter-item expanded "><a href="guides/index.html"><strong aria-hidden="true">3.</strong> Additional Guides</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="guides/incremental-adoption.html"><strong aria-hidden="true">3.1.</strong> Incremental Adoption</a></li><li class="chapter-item expanded "><a href="guides/vscode.html"><strong aria-hidden="true">3.2.</strong> Integrating with VSCode</a></li><li class="chapter-item expanded "><a href="guides/shell-autocompletion.html"><strong aria-hidden="true">3.3.</strong> Shell Autocompletion</a></li></ol></li><li class="chapter-item expanded "><a href="reference/index.html"><strong aria-hidden="true">4.</strong> Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference/config.html"><strong aria-hidden="true">4.1.</strong> foundry.toml Reference</a></li><li class="chapter-item expanded "><a href="reference/ds-test.html"><strong aria-hidden="true">4.2.</strong> ds-test Reference</a></li><li class="chapter-item expanded "><a href="reference/cheatcodes.html"><strong aria-hidden="true">4.3.</strong> Cheatcodes Reference</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Foundry Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/onbjerg/foundry-book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p><img src="images/foundry-banner.png" alt="Foundry Banner" /></p>
<p>Foundry is a smart contract development toolchain. Foundry manages your dependencies, compiles your project, runs tests, deploys, and lets you interact with the chain from the command line.</p>
<blockquote>
<p>üìñ Contributing</p>
<p>You can contribute to this book on <a href="https://github.com/onbjerg/foundry-book">GitHub</a>.</p>
</blockquote>
<h3 id="sections"><a class="header" href="#sections">Sections</a></h3>
<p><strong><a href="getting-started">Getting Started</a></strong></p>
<p>To get started with Foundry, install Foundry and set up your first project.</p>
<p><strong><a href="forge">Forge Guide</a></strong></p>
<p>The guide will give you all you need to know about how to use <code>forge</code> to develop, test, and deploy smart contracts.</p>
<p><strong><a href="guides">Additional Guides</a></strong></p>
<p>More guides on various topics.</p>
<ul>
<li><a href="guides/incremental-adoption.html">Incremental Adoption</a></li>
<li><a href="guides/vscode.html">Integrating with VSCode</a></li>
<li><a href="guides/shell-autocompletion.html">Shell Autocompletion</a></li>
</ul>
<p><strong><a href="reference">Reference</a></strong></p>
<p>References on Foundry and Foundry-related tools.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h2>
<p>To get started with Foundry, install the toolchain and set up your first project.</p>
<ul>
<li><a href="getting-started/./installation.html">Installation</a></li>
<li><a href="getting-started/./first-steps.html">First steps with Foundry</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<h3 id="using-foundryup"><a class="header" href="#using-foundryup">Using <code>foundryup</code></a></h3>
<p>The easiest way to get Foundry is to install the latest release by using <code>foundryup</code>.</p>
<p>On Linux and macOS systems, this is done as follows:</p>
<pre><code class="language-sh">curl -L https://foundry.paradigm.xyz | bash
</code></pre>
<p>This will download <code>foundryup</code>. To start install Foundry, run:</p>
<pre><code class="language-sh">foundryup
</code></pre>
<p>If everything goes well, you will now have two binaries at your disposal: <code>forge</code> and <code>cast</code>.</p>
<p>On Windows, build from source.</p>
<p>Running <code>foundryup</code> again will update to the latest Foundry release. You can also revert to a specific version of Foundry with <code>foundryup -v $VERSION</code>.</p>
<h3 id="building-from-source"><a class="header" href="#building-from-source">Building from source</a></h3>
<p>To build from source, you need to get <a href="https://rust-lang.org">Rust</a> and Cargo. The easiest way to get both is by using <code>rustup</code>.</p>
<p>On Linux and macOS systems, this is done as follows:</p>
<pre><code class="language-sh">curl https://sh.rustup.rs -sSf | sh
</code></pre>
<p>It will download a script and start installation.</p>
<p>On Windows, download and run <code>rustup-init</code> from <a href="https://rustup.rs">rustup.rs</a>. It will start the installation in a console.</p>
<p>After this, run the following to build Foundry from source:</p>
<pre><code class="language-sh">cargo install --git https://github.com/gakonst/foundry --bins --locked
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="first-steps-with-foundry"><a class="header" href="#first-steps-with-foundry">First Steps with Foundry</a></h2>
<p>This section provides an overview of the <code>forge</code> command line tool. We demonstrate how to create a new project, compile, and test it.</p>
<p>To start a new project with Foundry, use <code>forge init</code>:</p>
<pre><code class="language-sh">$ forge init hello_foundry
</code></pre>
<p>Let's check out what <code>forge</code> generated for us:</p>
<pre><code class="language-sh">$ cd hello_foundry
$ tree .
.
‚îú‚îÄ‚îÄ lib
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ ds-test
‚îî‚îÄ‚îÄ src
    ‚îú‚îÄ‚îÄ Contract.sol
    ‚îî‚îÄ‚îÄ test
        ‚îî‚îÄ‚îÄ Contract.t.sol

6 directories, 7 files
</code></pre>
<p>We can build the project:</p>
<pre><code class="language-sh">$ forge build
compiling...
success.
</code></pre>
<p>And run the tests:</p>
<pre><code class="language-sh">$ forge test
compiling...
no files changed, compilation skipped.
Running 1 test for ContractTest.json:ContractTest
[PASS] testExample() (gas: 254)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="forge-guide"><a class="header" href="#forge-guide">Forge Guide</a></h1>
<p>Forge is a development and testing framework, similar to DappTools and Hardhat.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="creating-a-new-project"><a class="header" href="#creating-a-new-project">Creating a New Project</a></h2>
<p>To start a new project with Foundry, use <code>forge init</code>:</p>
<pre><code class="language-sh">$ forge init hello_foundry
</code></pre>
<p>This creates a new directory <code>hello_foundry</code> from the default template. This also initializes a new <code>git</code> repository.</p>
<p>If you want to create a new project using a different template, you would pass the <code>--template</code> flag, like so:</p>
<pre><code class="language-sh">forge init --template https://github.com/FrankieIsLost/forge-template hello_template
</code></pre>
<p>For now, let's check what the default template looks like:</p>
<pre><code class="language-sh">$ cd hello_foundry
$ tree .
.
‚îú‚îÄ‚îÄ lib
‚îÇ   ‚îî‚îÄ‚îÄ ds-test
‚îî‚îÄ‚îÄ src
    ‚îú‚îÄ‚îÄ Contract.sol
    ‚îî‚îÄ‚îÄ test
        ‚îî‚îÄ‚îÄ Contract.t.sol

6 directories, 7 files
</code></pre>
<p>The default template comes with one dependency installed: <code>ds-test</code>. This is the preferred assertion library used for Foundry projects. Additionally, the template also comes with an empty starter contract and a simple test.</p>
<p>Let's build the project:</p>
<pre><code class="language-sh">$ forge build
compiling...
success.
</code></pre>
<p>And run the tests:</p>
<pre><code class="language-sh">$ forge test
compiling...
no files changed, compilation skipped.
Running 1 test for ContractTest.json:ContractTest
[PASS] testExample() (gas: 254)
</code></pre>
<p>You'll notice that two new directories have popped up: <code>out</code> and <code>cache</code>.</p>
<p>The <code>out</code> directory contains your contract artifact, such as the ABI, while the <code>cache</code> is used by <code>forge</code> to only recompile what is necessary.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="working-on-an-existing-project"><a class="header" href="#working-on-an-existing-project">Working on an Existing Project</a></h2>
<p>If you download an existing project that uses Foundry, it is really easy to get going.</p>
<p>First, get the project from somewhere. In this example, we will clone the <code>forge-std</code> repository from GitHub:</p>
<pre><code class="language-sh">$ git clone --recursive https://github.com/brockelmore/forge-std
$ cd forge-std
</code></pre>
<p>Notice that we clone with the <code>--recursive</code> flag. This automatically pulls git submodules (which we use as dependencies) as well in case there are any.</p>
<p>To build, use <code>forge build</code>:</p>
<pre><code class="language-sh">$ forge build
compiling...
success.
</code></pre>
<p>And to test, use <code>forge test</code>:</p>
<pre><code class="language-sh">$ forge test
compiling...
no files changed, compilation skipped.
Running 4 tests for StdCheatsTest.json:StdCheatsTest
[PASS] testHoax() (gas: 12061)
[PASS] testHoaxOrigin() (gas: 12227)
[PASS] testStartHoax() (gas: 21464)
[PASS] testStartHoaxOrigin() (gas: 21619)

Running 9 tests for StdErrorsTest.json:StdErrorsTest
[PASS] testExpectArithmetic() (gas: 5652)
[PASS] testExpectAssertion() (gas: 4839)
[PASS] testExpectDiv() (gas: 5533)
[PASS] testExpectEnum() (gas: 5435)
[PASS] testExpectIntern() (gas: 5021)
[PASS] testExpectMem() (gas: 4884)
[PASS] testExpectMod() (gas: 5555)
[PASS] testExpectOOB() (gas: 5462)
[PASS] testExpectPop() (gas: 6991)

Running 26 tests for StdStorageTest.json:StdStorageTest
[PASS] testFailStorageCheckedWriteMapPacked() (gas: 130438)
[PASS] testFailStorageConst() (gas: 81915)
[PASS] testFailStorageNativePack() (gas: 332331)
[PASS] testStorageCheckedWriteDeepMap() (gas: 241705)
[PASS] testStorageCheckedWriteDeepMapStructA() (gas: 270910)
[PASS] testStorageCheckedWriteDeepMapStructB() (gas: 319479)
[PASS] testStorageCheckedWriteHidden() (gas: 167166)
[PASS] testStorageCheckedWriteMapAddr() (gas: 214549)
[PASS] testStorageCheckedWriteMapPackedSuccess() (gas: 213075)
[PASS] testStorageCheckedWriteMapStructA() (gas: 243722)
[PASS] testStorageCheckedWriteMapStructB() (gas: 291929)
[PASS] testStorageCheckedWriteMapUint() (gas: 214525)
[PASS] testStorageCheckedWriteObvious() (gas: 143624)
[PASS] testStorageCheckedWriteStructA() (gas: 190036)
[PASS] testStorageCheckedWriteStructB() (gas: 236141)
[PASS] testStorageDeepMap() (gas: 207713)
[PASS] testStorageDeepMapStructA() (gas: 236545)
[PASS] testStorageDeepMapStructB() (gas: 285069)
[PASS] testStorageHidden() (gas: 136554)
[PASS] testStorageMapAddrFound() (gas: 182086)
[PASS] testStorageMapStructA() (gas: 210616)
[PASS] testStorageMapStructB() (gas: 258995)
[PASS] testStorageMapUintFound() (gas: 182100)
[PASS] testStorageObvious() (gas: 112963)
[PASS] testStorageStructA() (gas: 158602)
[PASS] testStorageStructB() (gas: 204879)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="dependencies"><a class="header" href="#dependencies">Dependencies</a></h2>
<p>Forge manages dependencies using <a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">git submodules</a> by default, which means that it works with any GitHub repository that contains smart contracts.</p>
<h3 id="adding-a-dependency"><a class="header" href="#adding-a-dependency">Adding a dependency</a></h3>
<p>To add a dependency, run <code>forge install</code>:</p>
<pre><code class="language-sh">$ forge install Rari-Capital/solmate
Installing solmate in &quot;lib/solmate&quot;, (url: https://github.com/rari-capital/solmate, tag: None)
Cloning into 'lib/solmate'...
# Snip...
[master a492c5d] forge install: solmate
 2 files changed, 4 insertions(+)
 create mode 160000 lib/solmate
</code></pre>
<p>If we now check the <code>lib</code> folder:</p>
<pre><code class="language-sh">$ tree lib -L 1
lib
‚îú‚îÄ‚îÄ ds-test
‚îî‚îÄ‚îÄ solmate

2 directories, 0 files
</code></pre>
<p>We can see that Forge installed <code>solmate</code>!</p>
<h3 id="remapping-dependencies"><a class="header" href="#remapping-dependencies">Remapping dependencies</a></h3>
<p>Forge can remap dependencies to make them easier to import. Forge will automatically try to deduce some remappings for you:</p>
<pre><code class="language-sh">$ forge remappings
solmate/=lib/solmate/src/
weird-erc20/=lib/solmate/lib/weird-erc20/src/
ds-test/=lib/ds-test/src/
</code></pre>
<p>These remappings mean:</p>
<ul>
<li>To import from <code>solmate</code> we would write: <code>import &quot;solmate/Contract.sol&quot;;</code></li>
<li>To import from <code>weird-erc20</code> we would write: <code>import &quot;weird-erc20/Contract.sol&quot;;</code></li>
<li>To import from <code>ds-test</code> we would write: <code>import &quot;ds-test/Contract.sol&quot;;</code></li>
</ul>
<p>You can customize these remappings by creating a <code>remappings.txt</code> file in the root of your project.</p>
<p>Let's create a remapping called <code>solmate-utils</code> that points to the <code>utils</code> folder in the solmate repository!</p>
<pre><code class="language-sh">solmate-utils/=lib/solmate/src/utils/
</code></pre>
<p>Now we can import any of the contracts in <code>src/utils</code> of the solmate repository like so:</p>
<pre><code class="language-solidity">import &quot;solmate-utils/Contract.sol&quot;;
</code></pre>
<h3 id="hardhat-compatibility"><a class="header" href="#hardhat-compatibility">Hardhat compatibility</a></h3>
<p>Forge also supports Hardhat-style projects where dependencies are npm packages (stored in <code>node_modules</code>) and contracts are stored in <code>contracts</code> as opposed to source.</p>
<p>To enable Hardhat compatability mode pass the <code>--hh</code> flag.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="project-layout"><a class="header" href="#project-layout">Project Layout</a></h2>
<p>Forge is flexible on how you structure your project. By default, the structure is:</p>
<pre><code class="language-ignore">.
‚îú‚îÄ‚îÄ remappings.txt
‚îú‚îÄ‚îÄ foundry.toml
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ Contract.sol
‚îÇ   ‚îî‚îÄ‚îÄ test/
‚îÇ       ‚îî‚îÄ‚îÄ Contract.t.sol
‚îî‚îÄ‚îÄ lib/
    ‚îî‚îÄ‚îÄ ds-test/
</code></pre>
<ul>
<li>You can configure Foundry's behavior using <code>foundry.toml</code>.</li>
<li>Remappings are specified in <code>remappings.txt</code>.</li>
<li>The default directory for contracts is <code>src/</code>.</li>
<li>The default directory for tests is <code>src/test/</code>, where any contract with a function that starts with <code>test</code> is considered to be a test.</li>
<li>Dependencies are stored as git submodules in <code>lib/</code>.</li>
</ul>
<p>You can configure where Forge looks for both dependencies and contracts using the <code>--lib-paths</code> and <code>--contracts</code> flags respectively. Alternatively you can configure it in <code>foundry.toml</code>.</p>
<p>Combined with remappings, this gives you the flexibility needed to support the project structure of other toolchains such as Hardhat and Truffle.</p>
<p>For automatic Hardhat support you can also pass the <code>--hh</code> flag, which sets the following flags: <code>--lib-paths node_modules --contracts contracts</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="configuring-with-foundrytoml"><a class="header" href="#configuring-with-foundrytoml">Configuring with <code>foundry.toml</code></a></h2>
<p>Forge can be configured using a configuration file called <code>foundry.toml</code>, which is placed in the root of your project.</p>
<p>Configuration can be namespaced by profiles. The default profile is named <code>default</code>, from which all other profiles inherit.</p>
<p>Additionally, you can create a global <code>foundry.toml</code> in your home directory.</p>
<p>Let's take a look at a configuration file that contains two profiles: the default profile, which always enables the optimizer, as well as a CI profile, that always displays traces:</p>
<pre><code class="language-toml">[default]
optimizer = true
optimizer_runs = 20000

[ci]
verbosity = 4
</code></pre>
<p>When running <code>forge</code>, you can specify the profile to use using the <code>FOUNDRY_PROFILE</code> environment variable.</p>
<blockquote>
<p>üìö See the <a href="forge//reference/config.html"><code>foundry.toml</code> Reference</a> for a complete overview
of what you can configure.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="tests"><a class="header" href="#tests">Tests</a></h2>
<p>Forge can run your tests with the <code>forge test</code> command. All tests are written in Solidity.</p>
<p>Forge will look for the tests anywhere in your source directory. Any contract with a function that starts with <code>test</code> is considered to be a test. Usually, tests will be placed in <code>src/test</code> by convention and end with <code>.t.sol</code>.</p>
<p>Here's an example of running <code>forge test</code> in a freshly created project, that only has the default test:</p>
<pre><code class="language-sh">$ forge test
compiling...
success.
Running 1 test for ContractTest.json:ContractTest
[PASS] testExample() (gas: 254)
</code></pre>
<p>You can also run specific tests by passing a filter:</p>
<pre><code class="language-sh">$ forge test --match-contract ComplicatedContractTest --match-test testDeposit
compiling...
success.
Running 2 tests for ComplicatedContractTest.json:ComplicatedContractTest
[PASS] testDepositERC20() (gas: 27502)
[PASS] testDepositETH() (gas: 12254)
</code></pre>
<p>This will run the tests starting with <code>testDeposit</code> in the <code>ComplicatedContractTest</code> test contract.
Inverse versions of these flags also exist (<code>--no-match-contract</code> and <code>--no-match-test</code>).</p>
<h3 id="logs-and-traces"><a class="header" href="#logs-and-traces">Logs and traces</a></h3>
<p>The default behavior for <code>forge test</code> is to only display a summary of passing and failing tests. You can control this behavior by increasing the verbosity (using the <code>-v</code> flag). Each level of verbosity adds more information:</p>
<ul>
<li><strong>Level 2 (<code>-vv</code>)</strong>: Logs emitted during tests are also displayed.</li>
<li><strong>Level 3 (<code>-vvv</code>)</strong>: Stack traces for failing tests are also displayed.</li>
<li><strong>Level 4 (<code>-vvvv</code>)</strong>: Stack traces for all tests are displayed, and setup traces for failing tests are displayed.</li>
<li><strong>Level 5 (<code>-vvvvv</code>)</strong>: Stack traces and setup traces are always displayed.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="writing-tests"><a class="header" href="#writing-tests">Writing Tests</a></h2>
<p>Tests are written in Solidity. If the test function reverts, the test fails, otherwise it passes.</p>
<p>Let's go over the most common way of writing tests, using the <a href="https://github.com/dapphub/ds-test"><code>ds-test</code></a> library.</p>
<p><code>ds-test</code> provides basic logging and assertion functionality.</p>
<p>To use it in your testing contract, import <code>ds-test/test.sol</code> and inherit from <code>DSTest</code>, like so:</p>
<pre><code class="language-solidity">import &quot;ds-test/test.sol&quot;;

contract ContractTest is DSTest {
    // ... tests ...
}
</code></pre>
<p>Let's examine a basic test using <code>ds-test</code>:</p>
<pre><code class="language-solidity">import &quot;ds-test/test.sol&quot;;

contract BasicTest is DSTest {
    uint256 testNumber;

    function setUp() {
        testNumber = 42;
    }

    function testNumberIs42() {
        assertEq(testNumber, 42);
    }
}
</code></pre>
<p>Forge uses the following keywords in tests:</p>
<ul>
<li><code>setUp</code>: An optional function invoked before each test case is run
<pre><code class="language-solidity">Contract contract;

function setUp() public {
    contract = new Contract();
}
</code></pre>
</li>
<li><code>test</code>: Functions prefixed with <code>test</code> are run as a test case
<pre><code class="language-solidity">function testIncrement() public {
    contract.increment();
    assertEq(contract.counter(), 1);
}
</code></pre>
</li>
<li><code>testFail</code>: The inverse of the <code>test</code> prefix - if the function does not revert, the test fails.
<pre><code class="language-solidity">function testFailDecrement() public {
    contract.decrement(); // expected to fail
}
</code></pre>
</li>
</ul>
<br>
<p>It is possible to use other testing libraries or roll your own. For example, if you find yourself lacking a special type of assertion, you could extend <code>ds-test</code>.</p>
<blockquote>
<p>üìö See the <a href="forge//reference/ds-test.html"><code>ds-test</code> Reference</a> for a complete overview of
the logging functionality and assertions in <code>ds-test</code>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="cheatcodes"><a class="header" href="#cheatcodes">Cheatcodes</a></h2>
<p>Most of the time, simply testing your smart contracts outputs isn't enough. To manipulate the state of the blockchain, as well as test for specific reverts and events, Foundry is shipped with a set of cheatcodes.</p>
<p>Cheatcodes allow you to change the block number, your identity, and more. They are invoked by calling specific functions on a specially designated address: <code>0x7109709ECfa91a80626fF3989D68f67F5b1DD12D</code>. If you are using <code>ds-test</code>, then this address is assigned in a constant named <code>HEVM_ADDRESS</code>.</p>
<p>Let's write a test for a smart contract that is only callable by its owner.</p>
<pre><code class="language-solidity">pragma solidity ^0.8.0;

contract OwnerUpOnly {
  address public immutable owner;
  uint256 public count;

  constructor() {
    owner = msg.sender;
  }

  function increment() external {
    require(
      msg.sender == owner,
      &quot;only the owner can increment the count&quot;
    );
    count++;
  }
}

import &quot;ds-test/test.sol&quot;;

contract OwnerUpOnlyTest is DSTest {
  OwnerUpOnly upOnly;

  function setUp() public {
    upOnly = new OwnerUpOnly();
  }

  function testIncrementAsOwner() public {
    assertEq(upOnly.count(), 0);
    upOnly.increment();
    assertEq(upOnly.count(), 1);
  }
}
</code></pre>
<p>If we run <code>forge test</code> now, we will see that the test passes, since <code>OwnerUpOnlyTest</code> is the owner of <code>OwnerUpOnly</code>.</p>
<pre><code class="language-ignore">$ forge test
compiling...
success.
Running 1 test for OwnerUpOnlyTest.json:OwnerUpOnlyTest
[PASS] testIncrementAsOwner() (gas: 24810)
</code></pre>
<p>Let's make sure that someone who is definitely not the owner can't increment the count:</p>
<pre><code class="language-solidity">interface CheatCodes {
  function prank(address) external;
}

contract OwnerUpOnlyTest is DSTest {
  CheatCodes cheats = CheatCodes(HEVM_ADDRESS);
  OwnerUpOnly upOnly;

  // setUp
  // testIncrementAsOwner

  function testFailIncrementAsNotOwner() public {
    cheats.prank(address(0));
    upOnly.increment();
  }
}
</code></pre>
<p>If we run <code>forge test</code> now, we will see that all the test pass.</p>
<pre><code class="language-ignore">$ forge test
compiling...
success.
Running 2 tests for OwnerUpOnlyTest.json:OwnerUpOnlyTest
[PASS] testFailIncrementAsNotOwner() (gas: 4030)
[PASS] testIncrementAsOwner() (gas: 24639)
</code></pre>
<p>The test passed because the <code>prank</code> cheatcode changed our identity to the zero address for the next call (<code>upOnly.increment()</code>). The test case passed since we used the <code>testFail</code> prefix, however, using <code>testFail</code> is considered an anti-pattern since it does not tell us anything about <em>why</em> <code>upOnly.increment()</code> reverted.</p>
<p>If we run the tests again with traces turned on, we can see that we reverted with the correct error message.</p>
<pre><code class="language-ignore">$ forge test -vvvv
compiling...
no files changed, compilation skipped.
Running 2 tests for OwnerUpOnlyTest.json:OwnerUpOnlyTest
[PASS] testFailIncrementAsNotOwner() (gas: 4030)
Traces:
  [4030] OwnerUpOnlyTest::testFailIncrementAsNotOwner()
    ‚îú‚îÄ [0] VM::prank(0x0000000000000000000000000000000000000000)
    ‚îÇ   ‚îî‚îÄ ‚Üê ()
    ‚îú‚îÄ [325] OwnerUpOnly::increment()
    ‚îÇ   ‚îî‚îÄ ‚Üê &quot;only the owner can increment the count&quot;
    ‚îî‚îÄ ‚Üê &quot;only the owner can increment the count&quot;
</code></pre>
<p>To be sure in the future, let's make sure that we reverted because we are not the owner using the <code>expectRevert</code> cheatcode:</p>
<pre><code class="language-solidity">interface CheatCodes {
  function prank(address) external;
  function expectRevert(bytes calldata) external;
}

contract OwnerUpOnlyTest is DSTest {
  CheatCodes cheats = CheatCodes(HEVM_ADDRESS);
  OwnerUpOnly upOnly;

  // setUp
  // testIncrementAsOwner

  // Notice that we replaced `testFail` with `test`
  function testIncrementAsNotOwner() public {
    cheats.expectRevert(
      bytes(&quot;only the owner can increment the count&quot;)
    );
    cheats.prank(address(0));
    upOnly.increment();
  }
}
</code></pre>
<p>If we run <code>forge test</code> one last time, we see that the test still passes, but this time we are sure that it will always fail if we revert for any other reason.</p>
<pre><code class="language-ignore">$ forge test
compiling...
success.
Running 2 tests for OwnerUpOnlyTest.json:OwnerUpOnlyTest
[PASS] testIncrementAsNotOwner() (gas: 4917)
[PASS] testIncrementAsOwner() (gas: 24661)
</code></pre>
<blockquote>
<p>üìö See the <a href="forge//reference/cheatcodes.html">Cheatcodes Reference</a> for a complete overview of all the cheatcodes.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fuzz-testing"><a class="header" href="#fuzz-testing">Fuzz Testing</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="understanding-traces"><a class="header" href="#understanding-traces">Understanding Traces</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h2 id="continous-integration"><a class="header" href="#continous-integration">Continous Integration</a></h2>
<h3 id="github-actions"><a class="header" href="#github-actions">GitHub Actions</a></h3>
<p>To test your project using GitHub Actions, here is a sample workflow:</p>
<pre><code class="language-yml">on: [push]

name: test

jobs:
  check:
    name: Foundry project
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: recursive

      - name: Install Foundry
        uses: onbjerg/foundry-toolchain@v1
        with:
          version: nightly

      - name: Run tests
        run: forge test -vvv
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="debugger"><a class="header" href="#debugger">Debugger</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h2 id="cache"><a class="header" href="#cache">Cache</a></h2>
<p>Forge caches compiled contracts each time you build your project to provide incremental builds. This cache lives in <code>cache/</code>.</p>
<p>Additionally, Forge also saves contract artifacts in <code>out/</code>, such as ABIs.</p>
<p>Both of these directories can be removed using <code>forge clean</code>, and it is generally recommended to add them in your <code>.gitignore</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="additional-guides"><a class="header" href="#additional-guides">Additional Guides</a></h2>
<p>This chapter contains additional guides on various topics related to Foundry.</p>
<ul>
<li><a href="guides/./incremental-adoption.html">Incremental Adoption</a></li>
<li><a href="guides/./vscode.html">Integrating with VSCode</a></li>
<li><a href="guides/./shell-autocompletion.html">Shell Autocompletion</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="incremental-adoption"><a class="header" href="#incremental-adoption">Incremental Adoption</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h2 id="integrating-with-vscode"><a class="header" href="#integrating-with-vscode">Integrating with VSCode</a></h2>
<p>You can get Solidity support for Visual Studio Code by installing <a href="https://github.com/juanfranblanco/vscode-solidity">the VSCode Solidity extension</a>.</p>
<p>To make the extension play nice with Foundry, you will need to place your remappings in <code>remappings.txt</code>. If they are already in <code>foundry.toml</code>, copy them over and use <code>remappings.txt</code> instead. If you just use the autogenerated remappings that Foundry provides, run <code>forge remappings &gt; remappings.txt</code>.</p>
<p>If you use a non-standard project layout, you may have to add the following to your <code>.vscode</code>:</p>
<pre><code class="language-json">&quot;solidity.packageDefaultDependenciesContractsDirectory&quot;: &quot;src&quot;,
&quot;solidity.packageDefaultDependenciesDirectory&quot;: &quot;lib&quot;
</code></pre>
<p>Where <code>src</code> is the source code directory and <code>lib</code> is your dependency directory.</p>
<p>It is also recommended to specify a Solidity compiler version:</p>
<pre><code class="language-json">&quot;solidity.compileUsingRemoteVersion&quot;: &quot;v0.8.10&quot;
</code></pre>
<p>To get Foundry in line with the chosen version, add the following to your <code>default</code> profile in <code>foundry.toml</code>.</p>
<pre><code class="language-toml">solc_version = &quot;0.8.10&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="shell-autocompletion"><a class="header" href="#shell-autocompletion">Shell Autocompletion</a></h2>
<p>You can generate autocompletion shell scripts for <code>bash</code>, <code>elvish</code>, <code>fish</code>, <code>powershell</code>, and <code>zsh</code>.</p>
<h3 id="zsh-oh-my-zsh"><a class="header" href="#zsh-oh-my-zsh">zsh (<code>oh-my-zsh</code>)</a></h3>
<pre><code class="language-sh">mkdir -p $HOME/.oh-my-zsh/completions
forge completions zsh &gt; $HOME/.oh-my-zsh/completions/_forge
cast completions zsh &gt; $HOME/.oh-my-zsh/completions/_cast
source $HOME/.zshrc
</code></pre>
<h3 id="fish"><a class="header" href="#fish">fish</a></h3>
<pre><code class="language-sh">mkdir -p $HOME/.config/fish/completions
forge completions fish &gt; $HOME/.config/fish/completions/_forge.fish
cast completions fish &gt; $HOME/.config/fish/completions/_cast.fish
source $HOME/.config/fish/config.fish
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="reference"><a class="header" href="#reference">Reference</a></h2>
<p>References on Foundry and Foundry-related tools.</p>
<ul>
<li><a href="reference/./config.html"><code>foundry.toml</code> Reference</a></li>
<li><a href="reference/./ds-test.html"><code>ds-test</code> Reference</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="foundrytoml-reference"><a class="header" href="#foundrytoml-reference"><code>foundry.toml</code> Reference</a></h2>
<p>Foundry's configuration system allows you to configure its tools.</p>
<h3 id="profiles"><a class="header" href="#profiles">Profiles</a></h3>
<p>Configuration can be arbitrarily namespaced into profiles. The default profile is named <code>default</code>, and all other profiles inherit values from this profile.</p>
<p>You can select the profile to use by setting the <code>FOUNDRY_PROFILE</code> environment variable.</p>
<h3 id="global-configuration"><a class="header" href="#global-configuration">Global configuration</a></h3>
<p>You can create a <code>foundry.toml</code> file in your home folder to configure Foundry globally.</p>
<h3 id="environment-variables"><a class="header" href="#environment-variables">Environment variables</a></h3>
<p>Configuration can be overriden with <code>FOUNDRY_</code> and <code>DAPP_</code> prefixed environment variables.</p>
<h3 id="configuration-format"><a class="header" href="#configuration-format">Configuration format</a></h3>
<p>Configuration files are written in the <a href="https://toml.io">TOML format</a>, with simple key-value pairs inside of sections. The following gives a quick overview of all settings (and their default values), with detailed descriptions found below.</p>
<pre><code class="language-toml">[default]
src = 'src'                                                   # the source directory
test = 'test'                                                 # the test directory
out = 'out'                                                   # the output directory (for artifacts)
libs = ['lib']                                                # a list of library directories
remappings = []                                               # a list of remappings
libraries = []                                                # a list of deployed libraries to link against
cache = true                                                  # whether to cache builds or not
force = false                                                 # whether to ignore the cache (clean build)
evm_version = 'london'                                        # the evm version (by hardfork name)
#solc_version = '0.8.10'                                      # override for the solc version (setting this ignores `auto_detect_solc`)
auto_detect_solc = true                                       # enable auto-detection of the appropriate solc version to use
optimizer = true                                              # enable or disable the solc optimizer
optimizer_runs = 200                                          # the number of optimizer runs
verbosity = 0                                                 # the verbosity of tests
ignored_error_codes = []                                      # a list of ignored solc error codes
fuzz_runs = 256                                               # the number of fuzz runs for tests
ffi = false                                                   # whether to enable ffi or not
sender = '0x00a329c0648769a73afac7f9381e08fb43dbea72'         # the address of `msg.sender` in tests
tx_origin = '0x00a329c0648769a73afac7f9381e08fb43dbea72'      # the address of `tx.origin` in tests
initial_balance = '0xffffffffffffffffffffffff'                # the initial balance of the test contract
block_number = 0                                              # the block number we are at in tests
chain_id = 1                                                  # the chain id we are on in tests
gas_limit = 9223372036854775807                               # the gas limit in tests
gas_price = 0                                                 # the gas price (in wei) in tests
block_base_fee_per_gas = 0                                    # the base fee (in wei) in tests
block_coinbase = '0x0000000000000000000000000000000000000000' # the address of `block.coinbase` in tests
block_timestamp = 0                                           # the value of `block.timestamp` in tests
block_difficulty = 0                                          # the value of `block.difficulty` in tests
</code></pre>
<h3 id="configuration-keys"><a class="header" href="#configuration-keys">Configuration keys</a></h3>
<p>This section documents all configuration keys. All configuration keys must live under a profile, such as <code>default</code>.</p>
<h4 id="project"><a class="header" href="#project">Project</a></h4>
<p>Configuration related to the project in general.</p>
<h5 id="src"><a class="header" href="#src"><code>src</code></a></h5>
<ul>
<li>Type: string</li>
<li>Default: src</li>
<li>Environment: <code>FOUNDRY_SRC</code> or <code>DAPP_SRC</code></li>
</ul>
<p>The path to the contract sources relative to the root of the project.</p>
<h5 id="test"><a class="header" href="#test"><code>test</code></a></h5>
<ul>
<li>Type: string</li>
<li>Default: test</li>
<li>Environment: <code>FOUNDRY_TEST</code> or <code>DAPP_TEST</code></li>
</ul>
<p>The path to the test contract sources relative to the root of the project.</p>
<h5 id="out"><a class="header" href="#out"><code>out</code></a></h5>
<ul>
<li>Type: string</li>
<li>Default: out</li>
<li>Environment: <code>FOUNDRY_OUT</code> or <code>DAPP_OUT</code></li>
</ul>
<p>The path to put contract artifacts in, relative to the root of the project.</p>
<h5 id="libs"><a class="header" href="#libs"><code>libs</code></a></h5>
<ul>
<li>Type: array of strings (paths)</li>
<li>Default: lib</li>
<li>Environment: <code>FOUNDRY_LIBS</code> or <code>DAPP_LIBS</code></li>
</ul>
<p>An array of paths that contain libraries, relative to the root of the project.</p>
<h5 id="cache-1"><a class="header" href="#cache-1"><code>cache</code></a></h5>
<ul>
<li>Type: boolean</li>
<li>Default: true</li>
<li>Environment: <code>FOUNDRY_CACHE</code> or <code>DAPP_CACHE</code></li>
</ul>
<p>Whether or not to enable caching. If enabled, the result of compiling sources, tests, and dependencies, are cached in <code>cache</code>.</p>
<h5 id="force"><a class="header" href="#force"><code>force</code></a></h5>
<ul>
<li>Type: boolean</li>
<li>Default: false</li>
<li>Environment: <code>FOUNDRY_FORCE</code> or <code>DAPP_FORCE</code></li>
</ul>
<p>Whether or not to perform a clean build, discarding the cache.</p>
<h4 id="solidity-compiler"><a class="header" href="#solidity-compiler">Solidity compiler</a></h4>
<p>Configuration related to the behavior of the Solidity compiler.</p>
<h5 id="remappings"><a class="header" href="#remappings"><code>remappings</code></a></h5>
<ul>
<li>Type: array of strings (remappings)</li>
<li>Default: none</li>
<li>Environment: <code>FOUNDRY_REMAPPINGS</code> or <code>DAPP_REMAPPINGS</code></li>
</ul>
<p>An array of remappings in the following format: <code>&lt;name&gt;=&lt;target&gt;</code>.</p>
<p>A remapping <em>remaps</em> Solidity imports to different directories. For example, the following remapping</p>
<pre><code class="language-ignore">@openzeppelin/=node_modules/@openzeppelin/openzeppelin-contracts/
</code></pre>
<p>with an import like</p>
<pre><code class="language-solidity">import &quot;@openzeppelin/contracts/utils/Context.sol&quot;;
</code></pre>
<p>becomes</p>
<pre><code class="language-solidity">import &quot;node_modules/@openzeppelin/openzeppelin-contracts/contracts/utils/Context.sol&quot;;
</code></pre>
<h5 id="libraries"><a class="header" href="#libraries"><code>libraries</code></a></h5>
<ul>
<li>Type: array of strings (libraries)</li>
<li>Default: none</li>
<li>Environment: <code>FOUNDRY_LIBRARIES</code> or <code>DAPP_LIBRARIES</code></li>
</ul>
<p>An array of libraries to link against in the following format: <code>&lt;file&gt;:&lt;lib&gt;:&lt;address&gt;</code>, for example: <code>src/MyLibrary.sol:MyLibrary:0xfD88CeE74f7D78697775aBDAE53f9Da1559728E4</code>.</p>
<h5 id="solc_version"><a class="header" href="#solc_version"><code>solc_version</code></a></h5>
<ul>
<li>Type: string (semver)</li>
<li>Default: none</li>
<li>Environment: <code>FOUNDRY_SOLC_VERSION</code> or <code>DAPP_SOLC_VERSION</code></li>
</ul>
<p>If specified, overrides the auto-detection system (more below) and uses a single Solidity compiler version for the project.</p>
<p>Only strict versions are supported (i.e. <code>0.8.11</code> is valid, but <code>^0.8.0</code> is not).</p>
<h5 id="auto_detect_solc"><a class="header" href="#auto_detect_solc"><code>auto_detect_solc</code></a></h5>
<ul>
<li>Type: boolean</li>
<li>Default: true</li>
<li>Environment: <code>FOUNDRY_AUTO_DETECT_SOLC</code> or <code>DAPP_AUTO_DETECT_SOLC</code></li>
</ul>
<p>If enabled, Foundry will automatically try to resolve appropriate Solidity compiler versions to compile your project.</p>
<p>This key is ignored if <code>solc_version</code> is set.</p>
<h5 id="optimizer"><a class="header" href="#optimizer"><code>optimizer</code></a></h5>
<ul>
<li>Type: boolean</li>
<li>Default: true</li>
<li>Environment: <code>FOUNDRY_OPTIMIZER</code> or <code>DAPP_OPTIMIZER</code></li>
</ul>
<p>Whether or not to enable the Solidity compiler optimizer.</p>
<h5 id="optimizer_runs"><a class="header" href="#optimizer_runs"><code>optimizer_runs</code></a></h5>
<ul>
<li>Type: integer</li>
<li>Default: 200</li>
<li>Environment: <code>FOUNDRY_OPTIMIZER_RUNS</code> or <code>DAPP_OPTIMIZER_RUNS</code></li>
</ul>
<p>The amount of optimizer runs to perform.</p>
<h5 id="ignored_error_codes"><a class="header" href="#ignored_error_codes"><code>ignored_error_codes</code></a></h5>
<ul>
<li>Type: array of integers</li>
<li>Default: none for source, SPDX license identifiers and contract size for tests</li>
<li>Environment: <code>FOUNDRY_IGNORED_ERROR_CODES</code> or <code>DAPP_IGNORED_ERROR_CODES</code></li>
</ul>
<p>An array of Solidity compiler error codes to ignore during build, such as warnings.</p>
<h4 id="tests-1"><a class="header" href="#tests-1">Tests</a></h4>
<p>Configuration related to the behavior of <code>forge test</code>.</p>
<h5 id="verbosity"><a class="header" href="#verbosity"><code>verbosity</code></a></h5>
<ul>
<li>Type: integer</li>
<li>Default: 0</li>
<li>Environment: <code>FOUNDRY_VERBOSITY</code> or <code>DAPP_VERBOSITY</code></li>
</ul>
<p>The verbosity level to use during tests.</p>
<ul>
<li><strong>Level 2 (<code>-vv</code>)</strong>: Logs emitted during tests are also displayed.</li>
<li><strong>Level 3 (<code>-vvv</code>)</strong>: Stack traces for failing tests are also displayed.</li>
<li><strong>Level 4 (<code>-vvvv</code>)</strong>: Stack traces for all tests are displayed, and setup traces for failing tests are displayed.</li>
<li><strong>Level 5 (<code>-vvvvv</code>)</strong>: Stack traces and setup traces are always displayed.</li>
</ul>
<h5 id="evm_version"><a class="header" href="#evm_version"><code>evm_version</code></a></h5>
<ul>
<li>Type: string</li>
<li>Default: london</li>
<li>Environment: <code>FOUNDRY_EVM_VERSION</code> or <code>DAPP_EVM_VERSION</code></li>
</ul>
<p>The EVM version to use during tests. The value <strong>must</strong> be an EVM hardfork name, such as <code>london</code>, <code>byzantium</code>, etc.</p>
<h5 id="fuzz_runs"><a class="header" href="#fuzz_runs"><code>fuzz_runs</code></a></h5>
<ul>
<li>Type: integer</li>
<li>Default: 256</li>
<li>Environment: <code>FOUNDRY_FUZZ_RUNS</code> or <code>DAPP_FUZZ_RUNS</code></li>
</ul>
<p>The amount of fuzz runs to perform for each fuzz test case. Higher values gives more confidence in results at the cost of testing speed.</p>
<h5 id="ffi"><a class="header" href="#ffi"><code>ffi</code></a></h5>
<ul>
<li>Type: boolean</li>
<li>Default: false</li>
<li>Environment: <code>FOUNDRY_FFI</code> or <code>DAPP_FFI</code></li>
</ul>
<p>Whether or not to enable the <code>ffi</code> cheatcode.</p>
<p><strong>Warning:</strong> Enabling this cheatcode has security implications for your project, as it allows tests to execute arbitrary programs on your computer.</p>
<h5 id="sender"><a class="header" href="#sender"><code>sender</code></a></h5>
<ul>
<li>Type: string (address)</li>
<li>Default: 0x00a329c0648769a73afac7f9381e08fb43dbea72</li>
<li>Environment: <code>FOUNDRY_SENDER</code> or <code>DAPP_SENDER</code></li>
</ul>
<p>The value of <code>msg.sender</code> in tests.</p>
<h5 id="tx_origin"><a class="header" href="#tx_origin"><code>tx_origin</code></a></h5>
<ul>
<li>Type: string (address)</li>
<li>Default: 0x00a329c0648769a73afac7f9381e08fb43dbea72</li>
<li>Environment: <code>FOUNDRY_TX_ORIGIN</code> or <code>DAPP_TX_ORIGIN</code></li>
</ul>
<p>The value of <code>tx.origin</code> in tests.</p>
<h5 id="initial_balance"><a class="header" href="#initial_balance"><code>initial_balance</code></a></h5>
<ul>
<li>Type: string (hexadecimal)</li>
<li>Default: 0xffffffffffffffffffffffff</li>
<li>Environment: <code>FOUNDRY_INITIAL_BALANCE</code> or <code>DAPP_INITIAL_BALANCE</code></li>
</ul>
<p>The initial balance of the test contracts in wei, written in hexadecimal.</p>
<h5 id="block_number"><a class="header" href="#block_number"><code>block_number</code></a></h5>
<ul>
<li>Type: integer</li>
<li>Default: 0</li>
<li>Environment: <code>FOUNDRY_BLOCK_NUMBER</code> or <code>DAPP_BLOCK_NUMBER</code></li>
</ul>
<p>The value of <code>block.number</code> in tests.</p>
<h5 id="chain_id"><a class="header" href="#chain_id"><code>chain_id</code></a></h5>
<ul>
<li>Type: integer</li>
<li>Default: 1</li>
<li>Environment: <code>FOUNDRY_CHAIN_ID</code> or <code>DAPP_CHAIN_ID</code></li>
</ul>
<p>The value of the <code>chainid</code> opcode in tests.</p>
<h5 id="gas_limit"><a class="header" href="#gas_limit"><code>gas_limit</code></a></h5>
<ul>
<li>Type: integer</li>
<li>Default: 9223372036854775807</li>
<li>Environment: <code>FOUNDRY_GAS_LIMIT</code> or <code>DAPP_GAS_LIMIT</code></li>
</ul>
<p>The gas limit for each test case.</p>
<h5 id="gas_price"><a class="header" href="#gas_price"><code>gas_price</code></a></h5>
<ul>
<li>Type: integer</li>
<li>Default: 0</li>
<li>Environment: <code>FOUNDRY_GAS_PRICE</code> or <code>DAPP_GAS_PRICE</code></li>
</ul>
<p>The price of gas (in wei) in tests.</p>
<h5 id="block_base_fee_per_gas"><a class="header" href="#block_base_fee_per_gas"><code>block_base_fee_per_gas</code></a></h5>
<ul>
<li>Type: integer</li>
<li>Default: 0</li>
<li>Environment: <code>FOUNDRY_BLOCK_BASE_FEE_PER_GAS</code> or <code>DAPP_BLOCK_BASE_FEE_PER_GAS</code></li>
</ul>
<p>The base fee per gas (in wei) in tests.</p>
<h5 id="block_coinbase"><a class="header" href="#block_coinbase"><code>block_coinbase</code></a></h5>
<ul>
<li>Type: string (address)</li>
<li>Default: 0x0000000000000000000000000000000000000000</li>
<li>Environment: <code>FOUNDRY_BLOCK_COINBASE</code> or <code>DAPP_BLOCK_COINBASE</code></li>
</ul>
<p>The value of <code>block.coinbase</code> in tests.</p>
<h5 id="block_timestamp"><a class="header" href="#block_timestamp"><code>block_timestamp</code></a></h5>
<ul>
<li>Type: integer</li>
<li>Default: 0</li>
<li>Environment: <code>FOUNDRY_BLOCK_TIMESTAMP</code> or <code>DAPP_BLOCK_TIMESTAMP</code></li>
</ul>
<p>The value of <code>block.timestamp</code> in tests.</p>
<h5 id="block_difficulty"><a class="header" href="#block_difficulty"><code>block_difficulty</code></a></h5>
<ul>
<li>Type: integer</li>
<li>Default: 0</li>
<li>Environment: <code>FOUNDRY_BLOCK_DIFFICULTY</code> or <code>DAPP_BLOCK_DIFFICULTY</code></li>
</ul>
<p>The value of <code>block.difficulty</code> in tests.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="ds-test-reference"><a class="header" href="#ds-test-reference"><code>ds-test</code> Reference</a></h2>
<p><code>ds-test</code> provides basic logging and assertion functionality. </p>
<p>To use it in your testing contract, import the <code>test.sol</code> and inherit from <code>DSTest</code>, like so:</p>
<pre><code class="language-solidity">import &quot;ds-test/src/test.sol&quot;

contract ContractTest is DSTest {}
</code></pre>
<h3 id="cheatcodes-address"><a class="header" href="#cheatcodes-address">Cheatcodes Address</a></h3>
<p>You can get the address of the cheatcodes account by accessing the <code>HEVM_ADDRESS</code> constant:</p>
<pre><code class="language-solidity">Vm vm = Vm(HEVM_ADDRESS);
</code></pre>
<h3 id="logging"><a class="header" href="#logging">Logging</a></h3>
<p><code>DSTest</code> contains the following events for logging:</p>
<blockquote>
<p>log(string)</p>
</blockquote>
<pre><code class="language-solidity">emit log(&quot;here&quot;);
</code></pre>
<br>
<blockquote>
<p>logs(bytes)</p>
</blockquote>
<pre><code class="language-solidity">emit logs(bytes(&quot;abcd&quot;));
</code></pre>
<br>
<blockquote>
<p>log_&lt;type&gt;(&lt;type&gt;)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>address</code>, <code>bytes32</code>, <code>int</code>, <code>uint</code>, <code>bytes</code>, <code>string</code></p>
<pre><code class="language-solidity">uint256 amount = 1 ether;
emit log_uint(amount);
</code></pre>
<br>
<blockquote>
<p>log_named_&lt;type&gt;(string key, &lt;type&gt; val)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>address</code>, <code>bytes32</code>, <code>int</code>, <code>uint</code>, <code>bytes</code>, <code>string</code></p>
<pre><code class="language-solidity">uint256 amount = 1 ether;
emit log_named_uint(&quot;amount&quot;, amount);
</code></pre>
<br>
<blockquote>
<p>log_named_decimal_&lt;type&gt;(string key, &lt;type&gt; val, uint decimals)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>int</code>, <code>uint</code></p>
<pre><code class="language-solidity">uint256 amount = 1 ether;
emit log_named_decimal_uint(&quot;amount&quot;, amount, 18);
</code></pre>
<h3 id="assertions"><a class="header" href="#assertions">Assertions</a></h3>
<p><code>DSTest</code> contains the following assertion functions:</p>
<blockquote>
<p>assertTrue(bool condition)</p>
</blockquote>
<p>Asserts the <code>condition</code> is true.</p>
<pre><code class="language-solidity">(bool sent, bytes memory data) = _to.call{value: msg.value}(&quot;&quot;);
assertTrue(sent);
</code></pre>
<br>
<blockquote>
<p>assertEq(&lt;type&gt; a, &lt;type&gt; b)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>address</code>, <code>bytes32</code>, <code>int</code>, <code>uint</code></p>
<p>Asserts <code>a</code> is equal to <code>b</code>.</p>
<pre><code class="language-solidity">uint256 amount = 1 ether;
assertEq(amount, 1e18);
</code></pre>
<br>
<blockquote>
<p>assertEqDecimal(&lt;type&gt; a, &lt;type&gt; b, uint decimals)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>int</code>, <code>uint</code></p>
<p>Asserts <code>a</code> is equal to <code>b</code>.</p>
<pre><code class="language-solidity">uint256 amount = 1 ether;
assertEqDecimal(amount, 1e18, 18);
</code></pre>
<br>
<blockquote>
<p>assertEq32(bytes32 a, bytes32 b)</p>
</blockquote>
<p>Asserts <code>a</code> is equal to <code>b</code>.</p>
<pre><code class="language-solidity">assertEq(bytes32(&quot;abcd&quot;), 0x6162636400000000000000000000000000000000000000000000000000000000);
</code></pre>
<br>
<blockquote>
<p>assertEq0(bytes a, bytes b)</p>
</blockquote>
<p>Asserts <code>a</code> is equal to <code>b</code>.</p>
<pre><code class="language-solidity">string memory name1 = &quot;Alice&quot;;
string memory name2 = &quot;Bob&quot;;
assertEq0(bytes(name1), bytes(name2));
</code></pre>
<br>
<blockquote>
<p>assertGt(&lt;type&gt; a, &lt;type&gt; b)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>int</code>, <code>uint</code></p>
<p>Asserts  <code>a</code> is greater than or equal to <code>b</code>.</p>
<pre><code class="language-solidity">assertGt(1, 1);
</code></pre>
<br>
<blockquote>
<p>assertGtDecimal (&lt;type&gt; a, &lt;type&gt; b, uint decimals)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>int</code>, <code>uint</code></p>
<p>Asserts  <code>a</code> is greater than or equal to <code>b</code>.</p>
<pre><code class="language-solidity">assertGt(1, 1, 0);
</code></pre>
<br>
<blockquote>
<p>assertGe (&lt;type&gt; a, &lt;type&gt; b)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>int</code>, <code>uint</code></p>
<p>Asserts  <code>a</code> is greater than <code>b</code>.</p>
<pre><code class="language-solidity">assertGt(1, 0);
</code></pre>
<br>
<blockquote>
<p>assertGeDecimal (&lt;type&gt; a, &lt;type&gt; b, uint decimals)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>int</code>, <code>uint</code></p>
<p>Asserts  <code>a</code> is greater than <code>b</code>.</p>
<pre><code class="language-solidity">assertGt(1, 0, 0);
</code></pre>
<br>
<blockquote>
<p>assertLt (&lt;type&gt; a, &lt;type&gt; b)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>int</code>, <code>uint</code></p>
<p>Asserts  <code>a</code> is less than or equal to <code>b</code>.</p>
<pre><code class="language-solidity">assertGt(1, 1);
</code></pre>
<br>
<blockquote>
<p>assertLtDecimal (&lt;type&gt; a, &lt;type&gt; b, uint decimals)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>int</code>, <code>uint</code></p>
<p>Asserts  <code>a</code> is less than or equal to <code>b</code>.</p>
<pre><code class="language-solidity">assertGt(1, 1, 0);
</code></pre>
<br>
<blockquote>
<p>assertLe (&lt;type&gt; a, &lt;type&gt; b)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>int</code>, <code>uint</code></p>
<p>Asserts  <code>a</code> is less than <code>b</code>.</p>
<pre><code class="language-solidity">assertGt(0, 1);
</code></pre>
<br>
<blockquote>
<p>assertLeDecimal (&lt;type&gt; a, &lt;type&gt; b, uint decimals)</p>
</blockquote>
<p>Where <code>&lt;type&gt;</code> can be <code>int</code>, <code>uint</code></p>
<p>Asserts  <code>a</code> is less than <code>b</code>.</p>
<pre><code class="language-solidity">assertGt(0, 1, 0);
</code></pre>
<br>
<blockquote>
<p>‚ÑπÔ∏è Information</p>
<p>You can pass a custom error message to the above functions by providing an additional parameter <code>string err</code>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="cheatcodes-reference"><a class="header" href="#cheatcodes-reference">Cheatcodes Reference</a></h2>
<p>Cheatcodes give you the ability to alter the state of the EVM, mock data, assert on reverts, and more.</p>
<p>To enable a cheatcode you call designated functions on the cheatcode address: <code>0x7109709ECfa91a80626fF3989D68f67F5b1DD12D</code>.</p>
<h3 id="cheatcodes-interface"><a class="header" href="#cheatcodes-interface">Cheatcodes Interface</a></h3>
<p>This is a complete overview of all the available cheatcodes. For detailed descriptions and example usage, see below.</p>
<pre><code class="language-solidity">interface CheatCodes {
    // Set block.timestamp
    function warp(uint256) external;
    // Set block.number
    function roll(uint256) external;
    // Set block.basefee
    function fee(uint256) external;
    // Loads a storage slot from an address
    function load(address account, bytes32 slot) external returns (bytes32);
    // Stores a value to an address' storage slot
    function store(address account, bytes32 slot, bytes32 value) external;
    // Signs data
    function sign(uint256 privateKey, bytes32 digest) external returns (uint8 v, bytes32 r, bytes32 s);
    // Computes address for a given private key
    function addr(uint256 privateKey) external returns (address);
    // Performs a foreign function call via terminal
    function ffi(string[] calldata) external returns (bytes memory);
    // Sets the *next* call's msg.sender to be the input address
    function prank(address) external;
    // Sets all subsequent calls' msg.sender to be the input address until `stopPrank` is called
    function startPrank(address) external;
    // Sets the *next* call's msg.sender to be the input address, and the tx.origin to be the second input
    function prank(address, address) external;
    // Sets all subsequent calls' msg.sender to be the input address until `stopPrank` is called, and the tx.origin to be the second input
    function startPrank(address, address) external;
    // Resets subsequent calls' msg.sender to be `address(this)`
    function stopPrank() external;
    // Sets an address' balance
    function deal(address who, uint256 newBalance) external;
    // Sets an address' code
    function etch(address who, bytes calldata code) external;
    // Expects an error on next call
    function expectRevert(bytes calldata) external;
    function expectRevert(bytes4) external;
    // Record all storage reads and writes
    function record() external;
    // Gets all accessed reads and write slot from a recording session, for a given address
    function accesses(address) external returns (bytes32[] memory reads, bytes32[] memory writes);
    // Prepare an expected log with (bool checkTopic1, bool checkTopic2, bool checkTopic3, bool checkData).
    // Call this function, then emit an event, then call a function. Internally after the call, we check if
    // logs were emitted in the expected order with the expected topics and data (as specified by the booleans)
    function expectEmit(bool, bool, bool, bool) external;
    // Mocks a call to an address, returning specified data.
    // Calldata can either be strict or a partial match, e.g. if you only
    // pass a Solidity selector to the expected calldata, then the entire Solidity
    // function will be mocked.
    function mockCall(address, bytes calldata, bytes calldata) external;
    // Clears all mocked calls
    function clearMockedCalls() external;
    // Expect a call to an address with the specified calldata.
    // Calldata can either be strict or a partial match
    function expectCall(address, bytes calldata) external;
    function getCode(string calldata) external returns (bytes memory);
}
</code></pre>
<h3 id="cheatcodes-1"><a class="header" href="#cheatcodes-1">Cheatcodes</a></h3>
<p>This section documents all cheat codes, gotchas, and provides usage examples.</p>
<h4 id="warp"><a class="header" href="#warp"><code>warp</code></a></h4>
<pre><code class="language-solidity">function warp(uint256) external;
</code></pre>
<p>Sets <code>block.timestamp</code>.</p>
<h4 id="roll"><a class="header" href="#roll"><code>roll</code></a></h4>
<pre><code class="language-solidity">function roll(uint256) external;
</code></pre>
<p>Sets <code>block.number</code>.</p>
<h4 id="fee"><a class="header" href="#fee"><code>fee</code></a></h4>
<pre><code class="language-solidity">function fee(uint256) external;
</code></pre>
<p>Sets <code>block.basefee</code>.</p>
<h4 id="load"><a class="header" href="#load"><code>load</code></a></h4>
<pre><code class="language-solidity">function load(address account, bytes32 slot) external returns (bytes32);
</code></pre>
<p>Loads the value from storage slot <code>slot</code> on account <code>account</code>.</p>
<h4 id="store"><a class="header" href="#store"><code>store</code></a></h4>
<pre><code class="language-solidity">function store(address account, bytes32 slot, bytes32 value) external;
</code></pre>
<p>Stores the value <code>value</code> in storage slot <code>slot</code> on account <code>account</code>.</p>
<h4 id="sign"><a class="header" href="#sign"><code>sign</code></a></h4>
<pre><code class="language-solidity">function sign(uint256 privateKey, bytes32 digest) external returns (uint8 v, bytes32 r, bytes32 s);
</code></pre>
<p>Signs a digest <code>digest</code> with private key <code>privateKey</code>, returning <code>(v, r, s)</code>.</p>
<p>This is useful for testing functions that take signed data and performs an <code>ecrecover</code> to verify the signer.</p>
<h4 id="addr"><a class="header" href="#addr"><code>addr</code></a></h4>
<pre><code class="language-solidity">function addr(uint256 privateKey) external returns (address);
</code></pre>
<p>Computes the address for a given private key.</p>
<h4 id="ffi-1"><a class="header" href="#ffi-1"><code>ffi</code></a></h4>
<pre><code class="language-solidity">function ffi(string[] calldata) external returns (bytes memory);
</code></pre>
<p>Calls an arbitrary command if <a href="reference/./config.html#ffi"><code>ffi</code></a> is enabled.</p>
<p>It is generally advised to use this cheat code as a last resort, and to not enable it by default, as anyone who can change the tests of a project will be able to execute arbitrary commands on devices that run the tests.</p>
<h4 id="prank"><a class="header" href="#prank"><code>prank</code></a></h4>
<pre><code class="language-solidity">function prank(address) external;
</code></pre>
<p>Sets <code>msg.sender</code> to the specified address <strong>for the next call</strong>. &quot;The next call&quot; includes static calls as well, but not calls to the cheat code address.</p>
<h5 id="alternative-signature"><a class="header" href="#alternative-signature">Alternative Signature</a></h5>
<pre><code class="language-solidity">function prank(address sender, address origin) external;
</code></pre>
<p>Sets <code>msg.sender</code> to <code>sender</code> and <code>tx.origin</code> to <code>origin</code> for the next call.</p>
<h4 id="startprank"><a class="header" href="#startprank"><code>startPrank</code></a></h4>
<pre><code class="language-solidity">function startPrank(address) external;
</code></pre>
<p>Sets <code>msg.sender</code> for all subsequent calls until <a href="reference/cheatcodes.html#stopprank"><code>stopPrank</code></a> is called.</p>
<h5 id="alternative-signature-1"><a class="header" href="#alternative-signature-1">Alternative Signature</a></h5>
<pre><code class="language-solidity">function startPrank(address sender, address origin) external;
</code></pre>
<p>Sets <code>msg.sender</code> to <code>sender</code> and <code>tx.origin</code> to <code>origin</code> for all subsequent calls until <a href="reference/cheatcodes.html#stopprank"><code>stopPrank</code></a> is called.</p>
<h4 id="stopprank"><a class="header" href="#stopprank"><code>stopPrank</code></a></h4>
<pre><code class="language-solidity">function stopPrank() external;
</code></pre>
<p>Resets <code>msg.sender</code> to <a href="reference/./config.html#sender"><code>FOUNDRY_SENDER</code></a>. Always used in conjunction with <a href="reference/cheatcodes.html#startprank"><code>startPrank</code></a>.</p>
<h4 id="deal"><a class="header" href="#deal"><code>deal</code></a></h4>
<pre><code class="language-solidity">function deal(address who, uint256 newBalance) external;
</code></pre>
<p>Sets the balance of an address <code>who</code> to <code>newBalance</code>.</p>
<h4 id="etch"><a class="header" href="#etch"><code>etch</code></a></h4>
<pre><code class="language-solidity">function etch(address who, bytes calldata code) external;
</code></pre>
<p>Sets the bytecode of an address <code>who</code> to <code>code</code>.</p>
<h4 id="expectrevert"><a class="header" href="#expectrevert"><code>expectRevert</code></a></h4>
<pre><code class="language-solidity">function expectRevert(bytes calldata msg) external;
</code></pre>
<p>If the <strong>next call</strong> does not revert with message <code>msg</code>, then <code>expectRevert</code> will.</p>
<p>To use <code>expectRevert</code> with a <code>string</code>, convert it to <code>bytes</code>.</p>
<pre><code class="language-solidity">cheats.expectRevert(bytes(&quot;error message&quot;));
</code></pre>
<p>To use <code>expectRevert</code> with a custom <a href="https://docs.soliditylang.org/en/v0.8.11/contracts.html#errors">error type</a> with parameters, ABI encode the error type.</p>
<pre><code class="language-solidity">cheats.expectRevert(
  abi.encodeWithSelector(MyContract.CustomError.selector, 1, 2)
)
</code></pre>
<h5 id="alternative-signature-2"><a class="header" href="#alternative-signature-2">Alternative Signature</a></h5>
<pre><code class="language-solidity">function expectRevert(bytes4) external;
</code></pre>
<p>An alternative version of <a href="reference/cheatcodes.html#expectrevert"><code>expectRevert</code></a> that only takes an error type signature. Useful for custom error types that do not take parameters.</p>
<pre><code class="language-solidity">cheats.expectRevert(MyContract.CustomError.selector)
</code></pre>
<h4 id="record"><a class="header" href="#record"><code>record</code></a></h4>
<pre><code class="language-solidity">function record() external;
</code></pre>
<p>Tell the VM to start recording all storage reads and writes. To access the reads and writes, use <a href="reference/cheatcodes.html#accesses"><code>accesses</code></a>.</p>
<h4 id="accesses"><a class="header" href="#accesses"><code>accesses</code></a></h4>
<pre><code class="language-solidity">function accesses(address) external returns (bytes32[] memory reads, bytes32[] memory writes);
</code></pre>
<p>Gets all storage slots that have been read (<code>reads</code>) or written to (<code>writes</code>) on an address.</p>
<p>Note that <a href="reference/cheatcodes.html#record"><code>record</code></a> must be called first.</p>
<h4 id="expectemit"><a class="header" href="#expectemit"><code>expectEmit</code></a></h4>
<pre><code class="language-solidity">function expectEmit(bool checkTopic1, bool checkTopic2, bool checkTopic3, bool checkData) external;
</code></pre>
<p>This cheat code is used to assert that certain logs are emitted on the next call.</p>
<ol>
<li>Call the cheat code, specifying whether we should check the first, second or third topic, and the log data.</li>
<li>Emit the event we are supposed to see after the next call.</li>
<li>Perform the call.</li>
</ol>
<p>For example:</p>
<pre><code class="language-solidity">function testERC20EmitsTransfer() public {
  // Only `src` and `dst` are indexed in ERC20's `Transfer` event,
  // so we only check topic 0 and 1, as well as the data (`amount`).
  cheats.expectEmit(true, true, false, true);

  // We emit the event we expect to see.
  emit MyToken.Transfer(address(this), address(1), 10);

  // We perform the call.
  myToken.transfer(address(1), 10);
}
</code></pre>
<h4 id="mockcall"><a class="header" href="#mockcall"><code>mockCall</code></a></h4>
<pre><code class="language-solidity">function mockCall(address where, bytes calldata data, bytes calldata retdata) external;
</code></pre>
<p>Mocks all calls to an address <code>where</code> if the call data either strictly or loosely matches <code>data</code> and returns <code>retdata</code>.</p>
<p>When a call is made to <code>where</code> the call data is first checked to see if it matches in its entirety with <code>data</code>. If not, the call data is checked to see if there is a partial match, with the match starting at the first byte of the call data.</p>
<p>If a match is found, then <code>retdata</code> is returned from the call.</p>
<p>Mocked calls are in effect until <a href="reference/cheatcodes.html#clearmockedcalls"><code>clearMockedCalls</code></a> is called.</p>
<h5 id="mocking-an-exact-call"><a class="header" href="#mocking-an-exact-call">Mocking an exact call</a></h5>
<pre><code class="language-solidity">function testMockCall() public {
  vm.mockCall(
    address(0),
    abi.encodeWithSelector(MyToken.balanceOf.selector, address(1)),
    abi.encode(10)
  );
  assertEq(IERC20(address(0)).balanceOf(address(1)), 10);
}
</code></pre>
<h5 id="mocking-an-entire-function"><a class="header" href="#mocking-an-entire-function">Mocking an entire function</a></h5>
<pre><code class="language-solidity">function testMockCall() public {
  vm.mockCall(
    address(0),
    abi.encodeWithSelector(MyToken.balanceOf.selector),
    abi.encode(10)
  );
  assertEq(IERC20(address(0)).balanceOf(address(1)), 10);
  assertEq(IERC20(address(0)).balanceOf(address(2)), 10);

  // and so on..
}
</code></pre>
<h4 id="clearmockedcalls"><a class="header" href="#clearmockedcalls"><code>clearMockedCalls</code></a></h4>
<pre><code class="language-solidity">function clearMockedCalls() external;
</code></pre>
<p>Clears all mocked calls.</p>
<h4 id="expectcall"><a class="header" href="#expectcall"><code>expectCall</code></a></h4>
<pre><code class="language-solidity">function expectCall(address where, bytes calldata data) external;
</code></pre>
<p>Expects at least one call to address <code>where</code> where the call data either strictly or loosely matches <code>data</code>.</p>
<p>When a call is made to <code>where</code> the call data is first checked to see if it matches in its entirety with <code>data</code>. If not, the call data is checked to see if there is a partial match, with the match starting at the first byte of the call data.</p>
<p>If the test terminates without the call being made, the test fails.</p>
<h4 id="getcode"><a class="header" href="#getcode"><code>getCode</code></a></h4>
<pre><code class="language-solidity">function getCode(string calldata) external returns (bytes memory);
</code></pre>
<p>Returns the bytecode for a contract in the project given the path to the contract.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="src/static/solidity.min.js"></script>
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
